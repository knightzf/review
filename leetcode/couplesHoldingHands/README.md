Only one thought after doing this. WTF!
There is no dp or optimal solution. Just loop through and move couple if it's not adjacent.

7/24\
Happened to see this problem again when Haoting was looking at it in the afternoon.\
Spent long time thinking and saw the previous comment.\
Fun! Looked at discussion still no good proof.
