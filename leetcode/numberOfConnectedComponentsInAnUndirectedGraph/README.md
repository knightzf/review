I tend to fall to the normal bfs solution.

Better solution is union find, which is basically try to trace to the lowest level of root.

The compression improves the runtime significantly.
