Thought for a long time and fell asleep.\
Couldn't find anything better than N^2.\
The solution is not the most obvious but very brilliant!\
Essentially solving a recursive problem top down.