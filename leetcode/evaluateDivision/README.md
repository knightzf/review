Managed to find solution to this problem.\
Thought for a while and didn't find a straightfoward solution to it.\
The division relationship propogates which looks very union-find like.\
Only difficulty is to correctly propogate the division result during find parent and union.
