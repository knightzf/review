Similar to the first problem, the difficulty here is there could be a case where a node has two parents.\
I thought for a long time and it seems it's impossible to find out which of the two parent edge should be removed.\
So I made it two steps and rest is the same as previous question using union find.