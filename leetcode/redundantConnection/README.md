Union find with path compression.