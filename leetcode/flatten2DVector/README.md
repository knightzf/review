Using iterator is pretty tricky with all the edge cases, not recommending doing it again.
