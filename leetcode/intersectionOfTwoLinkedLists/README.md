The solution is a little smart but can be very unefficient.
