Using line sweep algo is so easy to solve the second problem.
