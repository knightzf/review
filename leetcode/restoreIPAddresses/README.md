It's a divide and conqur problem but not very forward at the beginning.

The actual code is not that complex, just a few corner cases.
