It's a relatively simple backtracking problem.
The only tricky part is how to keep track of used elements.
My solution is definitely not the optimal.
