Tried recursive way, which times out badly.\
Thought about it, and used a matrix to store temporary probablities.\
Due to the limit of matrix size, it's actually much more performant.