The condition of being valid is a little bit tricky, I thought for a while before finding the solution.

4/19\
Again thought for long time, actually use a stack is enough.
