Tried to do this problem in one iteration, failed multiple times.\
It's very simple by looking yet hard to write very efficient code.