Typical BFS, no great way to solve it.

BFS from begin and end will speed up.
