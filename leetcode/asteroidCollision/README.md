It's easy to do it using a stack.\
But I decided to use a vector, which is quite tricky to get right.